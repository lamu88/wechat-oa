<include file="Common:header" />
	<link href="./Tpl/Qyapp/Static/Js/jstree/3.0.2/themes/default/style.min.css" rel="stylesheet">	
	<link href="./Tpl/Qyapp/Static/Js/bootstrap/switch/docs/css/highlight.css" rel="stylesheet">		
    <link href="./Tpl/Qyapp/Static/Js/bootstrap/switch/dist/css/bootstrap3/bootstrap-switch.min.css" rel="stylesheet">	
	<link href="./Tpl/Qyapp/Static/Js/daterangepicker/daterangepicker-bs3.css" rel="stylesheet">			
	<script src="./Tpl/Qyapp/Static/Js/artTemplate/dist/template.js" type="text/javascript"></script>
	<script src="./Tpl/Qyapp/Static/Js/jstree/3.0.2/jstree.min.js"></script>	
	<script src="./Tpl/Qyapp/Static/Js/bootstrap/switch/docs/js/highlight.js" type="text/javascript"></script>	
	<script src="./Tpl/Qyapp/Static/Js/bootstrap/switch/dist/js/bootstrap-switch.min.js" type="text/javascript"></script>
	<script src="./Tpl/Qyapp/Static/Js/daterangepicker/moment.min.js" type="text/javascript"></script>
	<script src="./Tpl/Qyapp/Static/Js/daterangepicker/daterangepicker.js" type="text/javascript"></script>
<div id="myModal" class="modal fade" tabindex="-2" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

</div>
<script type="text/javascript">
	$(document).ready(function() {
		var cb1 = function(start, end, label) {  
			//console.log(start.toISOString(), end.toISOString(), label);
			//$('#select_0 input').val(start.format('YYYY/MM/DD'));
			$('#select_0 input').attr('value',start.format('YYYY/MM/DD'));
		}
		var cb2 = function(start, end, label) {
			//console.log(start.toISOString(), end.toISOString(), label);
			//$('#select_3 input').val(start.format('YYYY/MM/DD') + ' - ' + end.format('YYYY/MM/DD'));
			$('#select_3 input').attr('value',start.format('YYYY/MM/DD') + ' - ' + end.format('YYYY/MM/DD'));
		}

		var optionSet1 = {
			singleDatePicker: true,
			ranges: {
				'今天': [moment(), moment()],
				'昨天': [moment().subtract('days', 1), moment().subtract('days', 1)],
				'最近7天': [moment().subtract('days', 6), moment()],
				'最近30天': [moment().subtract('days', 29), moment()],
				'这个月': [moment().startOf('month'), moment().endOf('month')],
				'上个月': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
			},
			buttonClasses: ['btn btn-default'],
			applyClass: 'btn-small btn-primary',
			cancelClass: 'btn-small',
			format: 'YYYY/MM/DD',
			separator: ' to ',
			locale: {
				applyLabel: '确定',
				cancelLabel: '取消',
				fromLabel: '开始时间',
				toLabel: '结束时间',
				customRangeLabel: '自定义',
				daysOfWeek: ['日', '一', '二', '三', '四', '五', '六'],
				monthNames: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
				firstDay: 1
			}
		};
		var optionSet2 = {
			startDate: moment().subtract('days', 29),
			endDate: moment(),
			dateLimit: {
				days: 60
			},
			showDropdowns: true,
			showWeekNumbers: true,
			timePicker: true,
			timePickerIncrement: 1,
			timePicker12Hour: true,
			ranges: {
				'今天': [moment(), moment()],
				'昨天': [moment().subtract('days', 1), moment().subtract('days', 1)],
				'最近7天': [moment().subtract('days', 6), moment()],
				'最近30天': [moment().subtract('days', 29), moment()],
				'这个月': [moment().startOf('month'), moment().endOf('month')],
				'上个月': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
			},
			opens: 'right',
			buttonClasses: ['btn btn-default'],
			applyClass: 'btn-small btn-primary',
			cancelClass: 'btn-small',
			format: 'YYYY/MM/DD',
			separator: ' to ',
			locale: {
				applyLabel: '确定',
				cancelLabel: '取消',
				fromLabel: '开始时间',
				toLabel: '结束时间',
				customRangeLabel: '自定义',
				daysOfWeek: ['日', '一', '二', '三', '四', '五', '六'],
				monthNames: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
				firstDay: 1
			}
		};		
		//按天查询
		//$('#select_0 input').val(moment().format('YYYY/MM/DD'));
		$('#select_0').daterangepicker(optionSet1, cb1);
		//$('#select_0').on('apply.daterangepicker', function(ev, picker) {
		//   $('form').submit(); 
		//});		
		//按月查询select_1
		//按时间段查询
		//$('#select_3 input').val(moment().subtract('days', 29).format('YYYY/MM/DD') + ' - ' + moment().format('YYYY/MM/DD'));
		$('#select_3').daterangepicker(optionSet2, cb2);	
		//$('#select_3').on('apply.daterangepicker', function(ev, picker) {
		//   $('form').submit(); 
		//});
	});
</script>
 
    <section class="hbox stretch">
    <aside class="aside-md bg-white b-r" id="subNav">
<!--         <div class="wrapper b-b header"><b>企业知识库</b></div>
        <ul class="nav">
		
			<li class="b-b b-light open"><a href="{lanrain::U('Knowledge/folder',array('id'=>$_GET['id']))}"  target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>文件夹管理</a></li>
			<li class="b-b b-light"><a href="{lanrain::U('Knowledge/files',array('id'=>$_GET['id']))}"  target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>文件管理</a></li>
			<li class="b-b b-light"><a href="{lanrain::U('Knowledge/back',array('id'=>$_GET['id']))}"  target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>反馈信息</a></li>
			<li class="b-b b-light"><a href="{lanrain::U('Knowledge/info',array('id'=>$_GET['id']))}" target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>数据统计</a></li>
						
			<li class="b-b b-light"><a href="{lanrain::U('Menu/menu',array('id'=>$_GET['id']))}"  target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>自定义菜单</a></li>
            <li class="b-b b-light">
                <a href="{lanrain::U('Appmsg/conf',array('id'=>$_GET['id']))}"  target="content"><i class="fa fa-chevron-right pull-right m-t-xs text-xs icon-muted"></i>应用管理</a>
            </li>
            
        </ul> -->
				<include file="Knowledge:navmenu" />
    </aside>	
        <aside>
			<section class="vbox">

                <header class="header bg-white b-b clearfix">
                    <form class="talbe-search" method="get"  target="_self" action="{lanrain::U('Knowledge/addFiles',array('mid'=>$_GET['mid']))}" id="Form">
                        <div class="row m-t-sm">
                            <div class="col-sm-8 m-b-xs">
<!--                                 <div class="btn-group">
                                    <button type="button" data-toggle="refresh" class="btn btn-sm btn-default" title="刷新">
                                        <i class="fa fa-refresh"></i>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-default" title="删除" data-toggle="batch" data-href="/Knowledge/FileRemove" disabled>
                                        <i class="fa fa-trash-o"></i>
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" data-trigger="batch" disabled>
                                    批量操作
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li>
                                            <a href="javascript:;" data-trigger="batch" data-remote="/Knowledge/FileRemove" data-toggle="ajaxPost" >删除</a>
                                        </li>
                                                                            </ul>
                                </div> -->

                                <div class="btn-group" style="display:none">
                                    <a href="{lanrain::U('Knowledge/addFiles',array('mid'=>$_GET['mid']))}" target="_self" class="btn btn-default btn-sm">上传文档</a>
                                </div>

                            </div>
                        </div>
					
                        <input type="hidden" name="pageNumber" id="pageNumber" value="1" />
                        <input type="hidden" name="orderBy" id="orderBy" value="desc"/>
                        <input type="hidden" name="order" id="order" value="jobs" />
                    </form>
                </header>
                <section class="scrollable wrapper w-f">
                    <section class="panel panel-default ">
                        <div class="table-responsive">
                            <table class="table table-hover m-b-none entity-view" data-path="/Knowledge/FileDetail?fid={0}&folder_id=">
                                <thead>
                                    <tr>
                                        <!-- <th class="with-checkbox">
                                            <input type="checkbox" />
                                        </th> -->
                                        <th>文档名称</th>
                                        <th>文件夹</th>
                                        <!-- <th>文档可见范围</th> -->
                                        <th>操作权限</th>
                                        <th>创建时间</th>
                                    </tr>
                                </thead>
                                <tbody id="mytable">
									<volist name="list" id="v">
									<tr id="{lanrain:$v.id}">
										<!-- <td>
											<input type="checkbox" >
										</td> -->
										<td>{lanrain:$v.title}</td>
										<td>{lanrain:$v.name}</td>
										<!-- <td>{lanrain:$v.dep}</td> -->
										<td>{lanrain:$v.power}</td>
										<td>{lanrain:$v.ctime|date="Y-m-d H:i:s",###}</td>
										
									</tr>
									</volist>                            
                                </tbody>
                            </table>
                        </div>
                    </section>
                </section>
                <footer class="footer bg-white b-t">
                    <div class="row text-center-xs">
                        <div class="col-md-6 hidden-sm">
                            <p class="text-muted m-t">总共0条 当前为第1页</p>
                        </div>
                        <div class="col-md-6 col-sm-12 text-right text-center-xs">
                            <ul class="pagination pagination-sm m-t-sm m-b-none" data-pages-total="0" data-page-current="1"></ul>
                        </div>
                    </div>
                </footer>

            </section>
        </aside>
	</section>
<!--       <footer class="footer bg-white b-t">
                    <div class="row text-center-xs">
                        <div class="col-md-6 hidden-sm">
								<span>总签到数：{lanrain:$ctime}天</span>&nbsp;&nbsp;
							    <span>总签退数：{lanrain:$otime}天</span>&nbsp;&nbsp;								
								<span>迟到总数：{lanrain:$latetime}小时</span>&nbsp;&nbsp;
								<span>早退总数：{lanrain:$earlytime}小时</span> 
                        </div>
						
                        <div class="col-md-6 col-sm-12 text-right text-center-xs">
                           <p class="text-muted m-t">{lanrain:$page}</p>
                        </div>
                    </div>
                </footer> -->
<!--             </section>
        </aside>
    </section>  -->
	
<section class="entity-panel hd" id="info">
</section>
<script src="./Tpl/Qyapp/Static/Js/weiyi.js" type="text/javascript"></script>	
<script type="text/javascript">

$('#mytable tr').click(function(){
	$(this).each(function(){
        var userId = $(this).attr('id');
		if($('#user'+userId).length>0){
			var curId = $('#info').children().attr('id');			
		    if(curId == 'user'+userId){
				if($('.entity-panel').hasClass('hd')){
					$('.entity-panel').removeClass('hd');
				}else{
					$('.entity-panel').addClass('hd');
				}			    
			}else{
				$('#info').empty();   
				$('#info').load("index.php?g=Qyapp&m=Knowledge&a=filesInfo&mid={lanrain::$_GET['mid']}&id="+userId);
				$('.entity-panel').removeClass('hd');
				$('.entity-panel').css('right','0px');				    
			}
		}else{
		    $('#info').empty();   
			$('#info').load("index.php?g=Qyapp&m=Knowledge&a=filesInfo&mid={lanrain::$_GET['mid']}&id="+userId);
			$('.entity-panel').removeClass('hd');
			$('.entity-panel').css('right','0px');			    
		}

		
	});
	
});	
</script>						
<include file="Common:footer" />