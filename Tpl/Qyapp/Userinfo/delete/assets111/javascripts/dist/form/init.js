/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/form/init",["$","./controls","dist/application/app","./validate","./tip"],function(a,b){"use strict";var c=(a("$"),a("./controls")),d=a("./validate");window.formValided=!0,b.init=function(a){c.init(a),d.init(a)}}),define("dist/form/controls",["$","dist/application/app"],function(a,b){"use strict";var c=a("$"),d=a("dist/application/app"),e=d.config,f=d.method;b.init=function(b){function d(){var a=KindEditor.editor({allowFileManager:!0});h.on("click",function(b){var d=c(b.target),e=d.prevAll("input[type=text]"),f=d.closest("div.input-group").find("input[type=text]"),g=d.data("insert"),h=d.data("input"),i=e.val();h&&(i=f.val()),a.loadPlugin("image",function(){a.plugin.imageDialog({imageUrl:i,clickFn:function(b){if(g||void 0==g){e.val(b).hide();var c=d.prevAll("img");if(c.length>0)c.attr("src",b).removeClass("hide");else{var i='<img class="thumb_img" src="{0}" style="max-height: 100px;">';e.before(i.format(b))}}else d.trigger("insert",b);h&&f.val(b),d.trigger("callback",b),a.hideDialog()}})})})}var g=c('[data-toggle="kindeditor"]',b),h=c('[data-toggle="selectimg"]',b);g.length>0?a.async("kindeditor",function(){g.each(function(){var a=c(this),b=a.data("config"),d=b?e.kindeditor[b]:e.kindeditor["default"];KindEditor.create(a,d)}),d()}):h.length>0&&a.async(["kindeditor","assets/kindeditor/themes/default/default.css"],function(){d()});var i=c('[data-toggle="method"]');if(i.length>0){var j=c("#method"),k=i.data("confirm");i.on("click",function(){var a=c(this),b=a.data("method"),d=function(){j.val(b),a.button("loading"),i.closest("form").submit()};k&&e.msg.msgbox.confirm(i.data("msg")||e.lang.confirmCloseOrder,function(a){a&&d()}),i.closest("form").valid()&&window.formValided&&!k&&f.validKindEditor()&&d()})}var l=c(".js_sortable",b);l.length&&function(){l.sortable()}();var l=c(".js_sortable");l.length&&function(){l.sortable()}();var m=c(".js_map",b);m.length&&a.async("dist/map/init.js",function(a){var b=new a;b.init(m),window.wm.map=b});var n=c(".js_partial_require",b);if(n.length){var o=function(){var a=c(".js_form_tips",b),d=!1;c.each(n,function(){return(d=c(this).val().trim().length>0)?!1:void a.addClass("error")}),d&&a.removeClass("error")};n.on("blur",o),c(b).on("click",'button[type="submit"]',function(){return o(),c(".js_form_tips",b).hasClass("error")?!1:void 0})}}}),define("dist/form/validate",["$","dist/application/app","dist/form/tip"],function(a,b){"use strict";var c=a("$"),d=a("dist/application/app"),e=d.config,f=d.method;b.init=function(b){var d=b.hasClass("form-modal"),h=null;d&&(h=b.parents(".modal"),h.on("hidden",function(){b.resetForm()}));var i={errorElement:"span",errorClass:"help-block error",errorPlacement:function(a,b){var c=b.parents(".input-group");c.length>0?c.after(a):b.after(a)},highlight:function(a){c(a).removeClass("error has-success").addClass("error")},success:function(a){a.addClass("valid")},onkeyup:function(a){c(a).valid()},onfocusout:function(a){c(a).valid()},submitHandler:function(a){var b=!0;if(b=f.validKindEditor()){var d=c("button[type='submit']",a);d.button("loading"),c(a).ajaxSubmit({dataType:"json",success:function(a){d.add(c("[data-toggle='method']")).button("reset"),h&&h.modal("hide"),g.run(a)},error:function(a){d.add(c("[data-toggle='method']")).button("reset"),h&&h.modal("hide"),e.msg.msgbox.alert(a.responseText)}})}}},j=b.data("ignore");j&&(i.ignore=j);var k=c("div.errorContainer"),l={errorContainer:c("div.errorContainer"),errorLabelContainer:c("div.errorLabelContainer"),errorElement:"label"};k.length>0&&c.extend(i,l),a.async(["validate","jform"],function(){b.each(function(){c(this).validate(i)})})};var g=a("dist/form/tip")}),define("dist/form/tip",["$","dist/application/app"],function(require,exports,module){"use strict";var $=require("$"),app=require("dist/application/app"),config=app.config;return exports.run=function(data){switch(data.status){case 0:config.msg.suc(data.message||config.lang.saveSuccess,data.url);break;default:config.msg.info(data.message||config.lang.exception,data.url)}data.callback&&eval(data.callback)},exports});